## Execution in Prolog

### Running a New Application

To run RTEC on a new application, follow these steps: 

1. **Create a directory for your application.** ``` cd examples && mkdir <newApplicationName> ```. 

2. **Create sub-directories for the input and output of RTEC.** ``` cd <newApplicationName> && mkdir resources dataset results ```. The following directories under "examples/\<newApplicationName\>" were created:
    - **resources** contains the event description of your application, and may optionally include ".prolog" files with auxiliary domain knowledge. 
    - **dataset** contains data stream files with input events on which the event description will be evaluated.
    - **results** is the destination folder for the log and result files created by RTEC after execution.
&nbsp;
3. **Create the event description of your application.** In order to create the event description of your application, you need to construct a ".patterns" file, containing the patterns defining the properties of your application, and a ".prolog" file containing a set of declarations which aid pattern compilation. For more information and examples on writing patterns and declarations for an application, consult the [manual of RTEC](../RTEC_manual.pdf) and the corresponding files of supported applications, located under the "examples" directory. Place the patterns file "\<rulesFileName\>.patterns" and the declarations file "\<declarationsFileName\>.prolog" you created in a new folder, named "patterns", under the resources directory. 

4. **Compile the event description of your application.** In order to compile the event description of your application, go to "src", open a terminal and type ``` swipl -l compiler.prolog ``` for SWI-Prolog or ``` yap -l compiler.prolog ``` for YAP. Then, run ``` compileEventDescription('../examples/<newApplicationName>/resources/patterns/<declarationsFileName>.prolog', '../examples/<newApplicationName>/resources/patterns/<rulesFileName>.patterns', '../examples/<newApplicationName>/resources/patterns/<rulesFileName>_compiled.prolog'). ```. Check if the compilation was successful. The compiled event description should be located in the file specified with the third argument of compileEventDescription/3. For an example on compiling an event description, you may consult the [manual of RTEC](../RTEC_manual.pdf). 

5. **Set the default parameter values for your application.** Go to "execution scripts" and edit the "handleApplication.prolog" file by declaring the default values of the execution parameters for your application. For example, you may declare that the default value of the window size parameter for your application is 10 time-points by adding the fact ```default(window_size,<newApplicationName>,10).``` in the "handleApplication.prolog" file. The event description and the input providers of an application are also execution parameters and should have a default value. Set the files "../examples/\<newApplicationName\>/resources/patterns/\<rulesFileName\>_compiled.prolog" and "../examples/\<newApplicationName\>/resources/patterns/\<declarationsFileName\>.prolog" as the event description of your application, *without* including the original, precompiled ".patterns" file. For some information on the input providers supported by RTEC, see Section 4.2 of this documentation. For additional help on setting default parameter values, see the default values set for the supported applications as a reference and the description of each parameter at the top of the "execution scripts/continuousQueries.prolog" file. 

6. **Consult the execution script with Prolog.** In "execution scripts", run ``` swipl -l continuousQueries.prolog ```  or ``` yap -l continuousQueries.prolog ``` depending on the Prolog distribution installed in your system.

7. **Run RTEC on your application.** Run the query ``` continuousQueries(<newApplicationName>). ``` to execute RTEC on your application with the default execution parameters you set. In order to pass custom execution parameters to the script, you may the query ``` continuousQueries(<newApplicationName>, <Parameterlist>). ```, where \<ParameterList\> is a list of key value pairs in the form of \<parameterName=parameterValue\>.  Some supported parameters are: window_size, step, start_time, end_time, input_mode and stream_rate. As an example, the query ``` continuousQueries(caviar, [window_size=200, step=200]). ``` runs RTEC on the human activity recognition application for a window and step size equal to 200 time-points, while the remaining parameters are assigned their default values. For the full list of supported parameters, see the comments in the "continuousQueries.prolog" file.

8. **Get execution results and logs.** Go to "examples/\<newApplicationName\>/results" and see the log and the result files of the execution.
